# Руководство по развертыванию на Render

Это руководство поможет вам развернуть приложение на Render для получения публичного HTTPS URL.

## Шаг 1: Подготовка репозитория

Убедитесь, что все изменения закоммичены в GitHub:
```bash
git add .
git commit -m "Prepare for Render deployment"
git push
```

## Шаг 2: Создание аккаунта на Render

1. Перейдите на [render.com](https://render.com)
2. Зарегистрируйтесь или войдите в аккаунт
3. Подключите свой GitHub аккаунт

## Шаг 3: Создание нового Web Service

1. В Dashboard Render нажмите "New +" → "Web Service"
2. Выберите ваш репозиторий `qr_tg_authorization`
3. Настройте следующие параметры:
   - **Name**: `qr-tg-authorization` (или любое другое имя)
   - **Environment**: `Python 3`
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `gunicorn app:app --bind 0.0.0.0:$PORT --workers 2 --threads 2 --timeout 120`
   
   ⚠️ **ВАЖНО**: Убедитесь, что команда начинается с `gunicorn` (с буквой 'g'), а НЕ `unicorn`!

## Шаг 4: Настройка переменных окружения

В разделе "Environment" добавьте следующие переменные:

### Обязательные переменные:
- `API_ID` - ваш API ID от Telegram (число)
- `API_HASH` - ваш API Hash от Telegram (строка)
- `SECRET_KEY` - случайная строка для безопасности (например, сгенерируйте через `python -c "import secrets; print(secrets.token_hex(32))"`)

### Опциональные переменные:
- `DEBUG` - установите в `False` для production
- `FLASK_HOST` - установите в `0.0.0.0`
- `PORT` - устанавливается автоматически Render, не нужно менять

## Шаг 5: Дополнительные настройки

1. **Plan**: Выберите подходящий план (Free tier доступен)
2. **Region**: Выберите ближайший регион
3. **Branch**: Убедитесь, что выбран `main` (или ваша основная ветка)

## Шаг 6: Развертывание

1. Нажмите "Create Web Service"
2. Render автоматически начнет сборку и развертывание
3. Дождитесь завершения процесса (обычно 2-5 минут)
4. После успешного развертывания вы получите URL вида: `https://your-app-name.onrender.com`

## Шаг 7: Проверка работы

1. Откройте полученный URL в браузере
2. Проверьте, что страница с QR-кодом загружается
3. Попробуйте отсканировать QR-код через Telegram

## Решение проблем

### Приложение не запускается
- Проверьте логи в Render Dashboard
- Убедитесь, что все переменные окружения установлены
- Проверьте, что `requirements.txt` содержит все необходимые зависимости

### Ошибки с сессиями
- Убедитесь, что директория `sessions/` существует (создается автоматически)
- На Render файловая система эфемерная, поэтому сессии могут не сохраняться при перезапуске

### Таймауты
- Render может завершать неактивные приложения через некоторое время
- При первом запросе после простоя приложение может запускаться медленно (холодный старт)

## Важные замечания

1. **Эфемерная файловая система**: Render использует эфемерную файловую систему, что означает:
   - Файлы сессий могут быть потеряны при перезапуске
   - QR-коды в `static/qr/` будут очищаться при перезапуске
   - Рекомендуется использовать внешнее хранилище для production

2. **Холодный старт**: На Free плане Render может усыплять приложение при неактивности. Первый запрос после простоя может занять 30-60 секунд.

3. **Лимиты**: На Free плане есть ограничения:
   - Ограничение по времени работы
   - Ограничение по ресурсам
   - Возможны таймауты при долгих операциях

## Альтернативы

Если Render не подходит, рассмотрите:
- **Heroku** - популярная платформа с Free tier
- **Railway** - современная платформа с простым деплоем
- **Fly.io** - быстрый и гибкий вариант
- **VPS** (DigitalOcean, Linode, etc.) - больше контроля, но требует настройки

